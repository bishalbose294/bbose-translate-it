<html>
   <head>
      <style>
	  body {
				background-image: url("https://cdn.olscafp.org/wp-content/uploads/2013/05/23141845/footer.jpg");
				font-family: Georgia, Times, serif;
				color: white;
				background-color: powderblue
				background-repeat: no-repeat;
				background-size: 100% 100%;
		}
	  
         #record {
				background-color:#B80C4D;
				border: #2e6da4;
				font-family: Arial, Geneva, Arial, Helvetica,  sans-serif;
				font-size: 15px;
				color: #fff;
				letter-spacing: 1px;
				padding: 8px 12px;
				font-size: 14px;
				font-weight: normal;
				border-radius: 4px;
				line-height: 1.5;
				text-decoration:none
         }
		 
         #stopRecord {
				background-color:#B80C4D;
				border: #2e6da4;
				font-family: Arial, Geneva, Arial, Helvetica,  sans-serif;
				font-size: 15px;
				color: #fff;
				letter-spacing: 1px;
				padding: 8px 12px;
				font-size: 14px;
				font-weight: normal;
				border-radius: 4px;
				line-height: 1.5;
				text-decoration:none
         }
		 .content {
				width: 500px;
				height: 600px;
				position: absolute; /*Can also be `fixed`*/
				left: 10%;
				right: 0;
				top: 30%;
				bottom: 0;
				margin: auto;
				/*Solves a problem in which the content is being cut when the div is smaller than its' wrapper:*/
				max-width: 100%;
				max-height: 100%;
				overflow: auto;
		}
         h2 {
         left: 100px;
         position: relative;
         }
		 
         #recordedAudio {
         left: 100px;
         right: 100px;
         position: relative;
         }
      </style>
   </head>
   <body>
      
	  <div class='content'>
	  <h2>Record in English</h2>
	  <br><br><br>
      <p align='center'>
         <button id=record>Record</button> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
         <button id=stopRecord disabled>Stop</button>
      </p>
	  <br><br><br>
      <p align='center'>
         <audio id=translatedAudio>
		 
         </audio>
      </p>
	  </div>
      <script>
		navigator.mediaDevices.getUserMedia({audio:true}).then(stream => {handlerFunction(stream)})
         
                  function handlerFunction(stream) {
                  rec = new MediaRecorder(stream);
                  rec.ondataavailable = e => {
                    audioChunks.push(e.data);
                    if (rec.state == "inactive"){
                      let blob = new Blob(audioChunks,{ type : 'audio/wav; codecs=0' });
         	let data = new FormData();
         	data.append('file', blob);
         	
         	var request = new XMLHttpRequest();
         	request.responseType = 'blob';
         	request.open("POST", "{{ url_for( 'textEngToHin') }}");
         	request.send(data);
         	
         	request.onload = function() {
         	   if (request.status == 200) {
         		  let blob_resp = new Blob([this.response],{ type : 'audio/wav; codecs=0' });
         		  console.log(blob_resp)
         		  var url = URL.createObjectURL(blob_resp);
         		  translatedAudio.load()
         		  translatedAudio.src = url;
         		  translatedAudio.controls=true;
         		  translatedAudio.autoplay=true;
         	   } else { 
         		  console.log(this.response)
         	   }
         	 };
                    }
                  }
                }
         
              record.onclick = e => {
                record.disabled = true;
                record.style.backgroundColor = "blue"
				stopRecord.style.backgroundColor = "red"
                stopRecord.disabled=false;
                audioChunks = [];
                rec.start();
              }
              stopRecord.onclick = e => {
                record.disabled = false;
                stopRecord.disabled=true;
                record.style.backgroundColor = "red"
				stopRecord.style.backgroundColor = "blue"
                rec.stop();
              }
	  </script>
   </body>
</html>
